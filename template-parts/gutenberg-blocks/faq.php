<?php

/**
 * faq Block Template.
 */

// Create id attribute allowing for custom "anchor" value.
$id = 'faq-' . $block['id'];
$className = 'block_100';

if ( !empty($block['anchor']) ) {
    $id = $block['anchor'];
}

// Create class attribute allowing for custom "className" and "align" values.
if ( !empty($block['className']) ) {
    $className .= ' ' . $block['className'];
}

if ( !empty($block['align']) ) {
    $className .= ' align' . $block['align'];
}

$title = get_field('title_faq');
$blocks = get_field('faq');
$title_w = get_field('title_w_faq');
$txt_w = get_field('txt_w_faq');
$txt_btn = get_field('txt_btn_faq');
$form = get_field('form_faq');
?>

<?php if ( !empty( $_POST['query']['preview'] ) ) : ?>

    <figure>
        <img src="<?php echo THEME_URI; ?>/img/gutenberg-preview/faq.png" alt="Preview" style="width:100%;">
    </figure>

<?php else : ?>

    <div id="<?php echo esc_attr($id); ?>" class="<?php echo esc_attr($className); ?>"> 
        <div class="container">   

            <?php if ($title) : ?>
                <h3><?php echo nl2br($title); ?></h3>
            <?php endif; ?>
     
            <div class="faq"> 
                
                <?php if ($blocks) : ?>
                    <div class="faq_vn">  
                        <div id="accordion-js">

                            <?php foreach ($blocks as $block) : ?>

                                <div class="item">
                                    <div class="heading">
                                        <?php echo nl2br($block['question_faq']); ?>
                                    </div>
                                    <div class="content">
                                        <?php echo nl2br($block['answer_faq']); ?>
                                    </div>
                                </div>

                            <?php endforeach; ?>

                        </div> 
                    </div> 
                <?php endif; ?>
                
                <div class="block_qestions white">
                    <div class="block_qestions_vn fon_gradient">
                        <svg width="70" height="62" viewBox="0 0 70 62" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M45.5583 7.94287C42.544 7.79266 39.83 9.95536 39.2496 12.9712C39.1915 13.2752 39.2563 13.5898 39.43 13.846C39.6036 14.1022 39.8718 14.279 40.1756 14.3377C40.8071 14.4587 41.4196 14.0445 41.5421 13.4116C41.9023 11.5304 43.5794 10.1814 45.4417 10.2733C47.6452 10.3827 48.8527 12.4593 49.0058 13.8987C49.156 15.2958 48.3525 16.4377 48.3438 16.4479C47.0805 18.2089 44.3679 17.973 43.3913 20.5006C43.1302 21.1758 43.0588 21.9166 43.1798 22.7027C43.2688 23.2787 43.766 23.6914 44.3319 23.6914C45.0545 23.6914 45.5945 23.0492 45.4869 22.3468C45.1016 19.8521 48.2434 20.5876 50.2396 17.8099C53.1042 13.7747 50.0663 8.1657 45.5583 7.94287ZM65.3333 0.0664062H24.7917C22.2177 0.0664062 20.125 2.16057 20.125 4.73307V32.4414C20.125 35.0139 22.2177 37.1081 24.7917 37.1081H32.9481C32.6791 39.1865 31.7511 41.0863 30.3552 42.5827C30.2052 42.7437 30.1038 42.9439 30.0625 43.1601C30.0212 43.3763 30.0418 43.5997 30.1219 43.8047C30.4388 44.6169 31.2358 44.5791 32.1373 44.5791C37.4372 44.5791 42.3668 41.481 43.3577 36.1543C43.4758 35.5214 43.0588 34.9118 42.4244 34.7952C42.2737 34.767 42.1191 34.7689 41.9691 34.8006C41.8192 34.8323 41.677 34.8932 41.5507 34.9799C41.4243 35.0665 41.3163 35.1773 41.2327 35.3057C41.1492 35.4342 41.0917 35.5778 41.0637 35.7285C40.3782 39.4068 37.2305 41.6789 33.5913 42.1539C34.7481 40.2512 35.3421 38.1356 35.3631 35.9531C35.3646 35.7989 35.3355 35.646 35.2775 35.5031C35.2196 35.3603 35.1339 35.2303 35.0254 35.1207C34.9169 35.0112 34.7878 34.9242 34.6455 34.8648C34.5033 34.8054 34.3506 34.7748 34.1965 34.7747H24.7917C23.5054 34.7747 22.4583 33.7277 22.4583 32.4414V4.73307C22.4583 3.44682 23.5054 2.39974 24.7917 2.39974H65.3333C66.6196 2.39974 67.6667 3.44682 67.6667 4.73307V32.4414C67.6667 33.7277 66.6196 34.7747 65.3333 34.7747H48.7083C48.0638 34.7747 47.5417 35.2968 47.5417 35.9414V49.7956C47.5417 51.0818 46.4946 52.1289 45.2083 52.1289H31.9477C31.2976 52.1289 30.7749 52.66 30.781 53.3072C30.802 55.4873 31.3949 57.6033 32.5529 59.5081C28.9285 59.035 25.7683 56.7734 25.0804 53.0827C25.0303 52.8148 24.8882 52.5729 24.6786 52.3988C24.469 52.2246 24.2052 52.1292 23.9327 52.1289H4.66667C3.38042 52.1289 2.33333 51.0818 2.33333 49.7956V22.0872C2.33333 20.801 3.38042 19.7539 4.66667 19.7539H12.5898C13.2344 19.7539 13.7565 19.2318 13.7565 18.5872C13.7565 17.9427 13.2344 17.4206 12.5898 17.4206H4.66667C2.09271 17.4206 0 19.5147 0 22.0872V49.7956C0 52.3681 2.09271 54.4622 4.66667 54.4622H23.011C24.4812 59.5612 29.7068 62.283 35.0219 61.8968C35.996 61.8239 36.4562 60.6549 35.789 59.9368C34.3958 58.4433 33.4655 56.5446 33.196 54.4622H45.2083C47.7823 54.4622 49.875 52.3681 49.875 49.7956V37.1081H65.3333C67.9073 37.1081 70 35.0139 70 32.4414V4.73307C70 2.16057 67.9073 0.0664062 65.3333 0.0664062ZM46.0833 26.9727C46.0833 27.817 45.3965 28.5039 44.5521 28.5039C43.7077 28.5039 43.0208 27.817 43.0208 26.9727C43.0208 26.1283 43.7077 25.4414 44.5521 25.4414C45.3965 25.4414 46.0833 26.1283 46.0833 26.9727Z" fill="white"/>
                        </svg>

                        <?php if ($title_w) : ?>
                            <strong>
                                <?php echo esc_html($title_w); ?>
                            </strong>
                        <?php endif; ?>

                        <?php if ($txt_w) : ?>
                            <p><?php echo esc_html($txt_w); ?></p>
                        <?php endif; ?>

                        <?php if ( $txt_btn && $form ) : ?>
                            <button type="button" class="btn_white open_popup" data-popup-id="<?php echo $id; ?>" onclick="return false">
                                <?php echo esc_html($txt_btn); ?>
                            </button>
                            <?php get_template_part('template-parts/modals/request', 'call', ['id' => $id, 'form' => $form]); ?>
                        <?php endif; ?>

                    </div>
                </div> 
            </div>
 
        </div>
    </div>

<?php endif; ?>